<!DOCTYPE html>
<html>
<head>
	<title>Frame</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://escartem.github.io/electron/frame/notify.js"></script>
	<!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-138501748-2"></script>
    <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-138501748-2');
    </script>
    <!-- Google Tag Manager -->
    <script>
    (function(w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            'gtm.start': new Date().getTime(),
            event: 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src =
            'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-PBF2TWW');
    </script>
    <!-- End Google Tag Manager -->
</head>
<body>
	<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBF2TWW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <script type="text/javascript">
    	// notify script to check updates
    	function notify(type, text, autoHide, autoHideTime) {
    		$.notify(text, {
    			clickToHide: false,
    			autoHide: autoHide,
    			autoHideDelay: autoHideTime,
    			position: "b l",
    			className: type
    		})
    	}

    	function rawVersion(version) {
    		var temp = version.split('.').join('');
    		return temp
    	}

    	function check() {
    		var latestVersion = "2.2.1";
    		var latestRawVersion = rawVersion(latestVersion);

    		var parameters = location.search.substring(1).split("&");
    		var temp = parameters[0].split("=");
    		var version = unescape(temp[1]);
    		temp = parameters[1].split("=");
    		lang = unescape(temp[1]);

    		var currentRawVersion = rawVersion(version);

    		if (lang == 'fr') {
    			var searching_update = "Recherche de mise à jour en cours...";
    			var no_update = "Aucune mise à jour";
    			var update_found = "La version " + latestVersion + " est disponible. Version actuelle : " + version + " \n Lien de téléchargement : bit.ly/UpdateFrame";
    		} else if (lang == 'en') {
    			var searching_update = "Searching for updates...";
    			var no_update = "No update found";
    			var update_found = "The version " + latestVersion + " is available. Current version : " + version + " \n Download link : bit.ly/UpdateFrame";
    		}

    		setTimeout(() => {
    			notify("info", searching_update, true, 7500);
    		}, 2000);

    		setTimeout(() => {
    			if (currentRawVersion < latestRawVersion) {
	    			notify("warn", update_found, true, 10000);
	    		} else {
	    			notify("success", no_update, true, 5000);
	    		}
    		}, 10000);
    	}

    	check();
    </script>
</body>
</html>